---
title: "EI-EP04-respuestas-equipo-1"
author: ""
date: "2025-09-07"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
library(pwr)
library(rcompanion)
library(RVAideMemoire)
library(tidyr)
```

```{r}
#antes de contestar las preguntas leeremos el data set
datos <- read.csv2("EP04 Datos.csv")
head(datos)
```

<h4> **Pregunta 1** </h4>

Una agencia de marketing desea determinar si hay una diferencia significativa en la efectividad de tres estrategias publicitarias utilizadas para promocionar un nuevo producto. Para ello, se ha recopilado información de personas que fueron expuestas a las tres estrategias publicitarias, registrando si mostraron una aceptación (A) o rechazo (R) a cada una de ellas.

¿Qué puede concluir la agencia de marketing sobre la efectividad de las estrategias publicitarias para promover el nuevo producto?

*Indicación: obtenga la muestra de 50 personas a partir del archivo “EP04 Datos.csv” que se encuentra en el directorio compartido, usando la semilla 102. Considere un nivel de significación α=0,05.*

**Respuesta**: Para responder a esta pregunta, primero formularemos las hipotesis de estudio las cuales son omnibus para diferencia de medias

- $H_0$: la proporcion de aceptacion de las estrategias es igual para las 3 estrategias
- $H_a$: la proporcion de aceptacion de las estrategias es diferentesd para las 3 estrategias

Además, tomaremos en cuenta que estamos en un caso de una varaible dicotomica la cual es 0 o 1, ademas la variable independiente es categoria de 3 niveles (estrategia_1, estrategia_2, estrategia_3), ademas sabemos que las observaciones son independientes entre si, tambien el tamaño de la muestra es bloques por tratamientos lo cual resulta en  $50\times 3 \geq 24$, por lo que se cumplen las condiciones para poder ocupar una prueba de mcnemar o q de cochran, pero en este caso ocuparemos la prueba de cochran, ya que se pueden apreciar 2 o mas tratamientos, más en espesifico, 3 tratamientos, y la prueba de mcnemar solo acepta 2. 

```{r}
set.seed(102)

#obtenermos los datos aleatorios del dataframe
indices_aleatorios <- sample(nrow(datos), 50)
datos_aleatorios <- datos[indices_aleatorios, ]

#mostramos los 5 primeros de la tabla
head(datos_aleatorios)

#ahora cambiaremos las letras por (A=1) y (B=0)

datos_aleatorios <- apply(datos_aleatorios, MARGIN=c(1,2), FUN = function(x) ifelse(x=="A",1,0) )

head(datos_aleatorios)

instancias<- c(1:50)

df_valores <- as.data.frame(datos_aleatorios[, 1:3])
colnames(df_valores) <- c("estrategia_1", "estrategia_2", "estrategia_3")
df_valores$instancias <- 1:nrow(df_valores)

# llevamos los datos a formalo largo
datos_largos <- df_valores |> pivot_longer(c("estrategia_1", "estrategia_2", "estrategia_3"),
                                             names_to = "personas", values_to = "resultados") |> mutate_at(c("instancias", "personas"), as.factor)

alfa<-0.05


#calculamos tamaño de muestra
N<- nrow(datos_aleatorios[, -1]) * ncol(datos_aleatorios[, -1])

prueba_qc <- cochran.qtest(resultados ~ personas | instancias, data = datos_largos, alpha = alfa)

cat("Resultado de la prueba Q de cochran:\n")
print(prueba_qc)
```

Con estos resultados, obtenemos un p-value de 1.691e-06 lo cual nos hace recahzar la hipotesis nula en favor de la hipotesis alternativa por lo que concluiremos que la proporcion de aceptacion de las estrategias es diferente para las 3 estrategias, para corroborar estos resultados haremos uso de una prueba post-hoc, la cual es la prueba post-hoc de benjamini y yekutielli y holm

```{r}
if(prueba_qc[["p.value"]] < alfa)
{
  #aplicamos procedimiento con post hoc
  post_hoc_1 <- pairwiseMcnemar(resultados ~ personas | instancias, data = datos_largos, test="mcnemar", correct=FALSE, method = "holm")
  
  print(post_hoc_1)
  #aplicamos el segundo procedimiento post-hoc
  post_hoc_2 <- pairwiseMcnemar(resultados ~ personas | instancias, data = datos_largos, test="mcnemar", correct=FALSE, method = "BY")

  print(post_hoc_2)  
}
```

A partir de los resultados podemos ver que entre la estrategia 1 en relación con las estrategias 1 y 2, entonces podemos ver que con un p-value de << 0 podemos decir que la aceptación no es igual, pero en relación con la aceptacion de la 2 en relación a la 3, esta si es igual, por lo que recomendamos volver a repetir el experimento pero con más datos

<h4> **Pregunta 2** </h4>

Una organización de conservación de la fauna silvestre estudia manadas de tres tipos de animales herbívoros en reservas naturales africanas. Se seleccionó aleatoriamente una muestra de 30 observaciones de los animales que se acercaron a beber agua en el principal afluente de las reservas Etosha y Mahago durante tres días consecutivos del mes de febrero. Se registraron 5 elefantes, 10 antílopes y 15 cebras en la primera, y 6 elefantes, 14 antílopes y 10 cebras en la segunda.
¿Existe evidencia de que la proporción de especies es la misma en ambas reservas?

Para responder esta pregunta se definen las hipótesis a docimar:

$H_0:$ Las proporciones de especies son iguales en ambas reservas
$H_a:$ HLas proporciones de especies son  distintas en ambas reservas

Para desarrollar una solucón, se utilizará la prueba de Chi-cuadrado.
Condiciones:
  1. La muestra se selecciona de manera aleatoria.
  2. Las variables son cualitativas
  3. Valores esperados superan las 5 observaciones (ver tabla)


```{r}

etosha <- c(5,10,15)
mahago <- c(6,14,10)

tabla <- as.table(rbind(etosha, mahago))
dimnames(tabla) <- list(reserva=c("etosha", "mahago"),
                        especies=c("elefante","antilopes","cebra"))

prueba <- chisq.test(tabla, correct = F)
print(tabla)
print(prueba)
```
Dado que el p-value es de 0.4153 y con un nivel de significancia de 0.05, no existe evidencia suficiente para rechazar la hipótesis nula, por lo tanto, se concluye que las proporciones de especies no son distintas en ambas reservaS.

<h4> **Pregunta 3** </h4>

Una organización dedicada a la rehabilitación de villanos ha observado que muchos de ellos ingresan al programa con niveles elevados de hostilidad. Para abordar este problema, decidieron implementar un nuevo programa de bienvenida diseñado para reducir la hostilidad y facilitar la reintegración a la sociedad. Para evaluar la efectividad de este programa, se reclutó a un grupo de 20 villanos a quienes se les midió el nivel de hostilidad (alto o bajo) antes y después de participar en el programa de bienvenida. Los resultados se presentan a continuación:
- 2 villanos no mostraron hostilidad ni antes ni después.
- 15 villanos que inicialmente mostraban hostilidad dejaron de hacerlo.
- 2 villanos mantuvieron un elevado nivel de hostilidad.
- el otro villano desarrolló síntomas de hostilidad tras participar en el programa cuando antes no era hostil.

¿Qué se puede concluir acerca de la efectividad del nuevo programa de bienvenida para reducir la hostilidad en los villanos?

Se definen las hipótesis a docimar

$H_o:$ No hay diferencias en los villanos tras ingresar al programa
$H_a:$ Hay diferencias en los villanos tras ingresar al programa


Se  decide utilizar McNemar para evaluar la prueba, además se cumplen las condiciones para hacer uso:

1. Los datos son pareados
2. Variable dicotómica: Si / No
3. Tamaño de la muestra b + c = 16 < 25 (según la lectura no es recomendable usar McNemar)
4. Muestras independientes

```{r}
#mcnemar
matriz <- matrix(c(2,15,1,2),
                nrow=2,
                byrow=TRUE,
                dimnames=list("Antes"=c("Hostilidad","No hostilidad"),
                              "Después"=c("Hostilidad","No hostilidad")))
print(matriz)
prueba <- mcnemar.test(matriz, correct = FALSE) # Se utiliza correct FALSE, ya que b + c < 25
print(prueba)
```

Con el p-value obtenido (0.0004653), se puede concluir que la efectividad del programa de bienvenida para reducir la hostilidad en los villanos es efectiva, ya que el valor es menor a un alfa 0.05, por lo que se rechaza la hipótesis nula.


<h4> **Pregunta 4** </h4>

Durante un apocalipsis zombie, un grupo de 10 mujeres y 14 hombres sobrevivientes se encuentra buscando desesperadamente refugio y encuentran dos edificios abandonados que podrían servir: una escuela y un centro comercial. Algunas personas piensan que la escuela es más segura, mientras que otras consideran que el centro comercial es más seguro. Después de elegir sus opciones, se observa que 6 mujeres y 10 hombres eligen refugiarse en la escuela abandonada mientras que los otros optan por el centro comercial.

¿Hay relación entre el sexo de la persona y el edificio abandonado que encuentra más seguro?

**Respuesta**: para responder primero, armaremos la matriz de la cual despues haremos el analisis, ocuparemos la prueba de fisher, ya que tenemos 2 varaibles categoricas donde una es dicotomica y la otra de niveles, (hombres y mujeres, que tienen una cantidad y los edificios que son una varaible categorica de dos niveles, escuela y centro comercial), a continuación, verificaremos las dos condiciones para poder realizar esta prueba, las cuales son:

- Las observaciones deben ser independientes entre si, bajo el enunciado, dentro de la decision de cada persona sobre en que edificio decidirá refujiarse y ademas asumiremos que cada persona no influye en la decición de las demás (esto bajo el enunciado)

- Solo deben haber menos de 5 observaciones, en este caso se cumple ya que en algunas celdas de la matriz existen menos de 5 observaciones lo que hace la alternativa de ocupar una prueba de chi-cuadrado sea infactible ya que al tener menos de 5 observaciones en algunas casillas, tendremos resultados distoriconados
```{r}
#armaremos la matriz ocupando 
matriz_datos <- matrix(c(6, 4, 10, 2), nrow=2, byrow = TRUE)
rownames(matriz_datos) <- c("Mujeres", "Hombre")
colnames(matriz_datos) <- c("Escuela", "Centro Comercial")

matriz_datos

#definimos el nivel de confianza
alfa <- 0.05
```

En base a esta matriz, aplicaremos la prueba de chi-cuadrado de pearson considerando las siguientes hipotesis

- $H_0$: el sexo de la persona y el edificio abandonado que encuentra mas seguro no estan relacionadas

- $H_a$: el sexo de la persona y el edificio abandonado que encuentra mas seguro estan relacionadas

```{r}
#Ahora con esto definido, podemos hacer la prueba de fisher

fisher.test(matriz_datos, alternative = "two.sided", conf.level = 1-alfa)

```

Con esto podemos ver que el p-value obtenido es de 0.3476 el cual es mayor que 0.05 que es nuestro nivel de confianza, por lo que aceptamos la hipotesis nula y concluimos que el sexo de la persona y el edificio abandonado que se encuentra más seguro no estan relacionadas, dado que estamos trabajando con una tabla de contingencia y con una prueba exacta de fisher, entonces no es necesario un procedimiento post-hoc ya que el hecho de aceptar o rechazar una hipotesis, nos dice si estan relacionadas o no que es lo que inicialmente se buscaba resolver.